<!DOCTYPE HTML>
<html>
    <head>
        <title>Western Virtual Tour</title>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="text/css" rel="stylesheet" href="css/cnstyle.css">
        <link type="text/css" rel="stylesheet" href="css/tipsy.css">
        <link type="text/css" rel="stylesheet" href="css/tipsy-docs.css">
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
        <script src="js/jquery.tipsy.js"></script>
        <script type="text/javascript">
            $(function () {
                $('.caption_wrapper').hide();
                if (location.hash !== "") {
                    $("#start").removeClass("show");
                }
                $("#start").find("a").on("click", function () {
                    $("#start").removeClass("show");
                    $(this).off("click");
                });

                /**
                 * Creates an instance of a Location Item
                 * @constructor
                 * @this {Navigation}
                 * @param {string} tag The location tag of the navigation item (should be in form # + location, i.e #hurst
                 * @param {string} name The name of the navigation item corresponding to div id to be filled
                 * @param {string} locationType Type of location, i.e. "academic", etc
                 * @param {string} description The description of the current location
                 * @param {Boolean} onCampus If location is on campus or off campus
                 */
                function Location(tag, name, locationType, description, onCampus) {
                    this.tag = tag;
                    this.name = name;
                    this.locationType = locationType; 
                    this.description = description;
                    this.onCampus = onCampus;
                }

                /**
                 * Location object instances
                 */
                var taylor = new Location("#taylor", "Taylor Hall", "academic",
                        "Home of administrative offices, classrooms, faculty offices, computer labs, as well as an " +
                        "auditorium and theater.", true);
                var quigley = new Location("#quigley", "Quigley Hall", "academic",
                        "Home of the Music and Art departments", true);
                var hurst = new Location("#hurst", "Hurst Hall", "academic",
                        "Home of Science and Mathematics departments", true);
                var kelley = new Location("#kelley", "Kelley Hall", "academic",
                        "Home of Social Sciences and Environment & Sustainability programs", true);
                var library = new Location("#library", "Leslie J. Savage Library", "studentlife",
                        "The research hub for campus and a great study spot", true);
                var universitycenter = new Location("#universitycenter", "University Center", "studentlife",
                        "The hub of student life on campus", true);
                var footballfield = new Location("#footballfield", "Mountaineer Bowl", "athletic",
                        "The world's highest collegiate football stadium", true);
                var telluride = new Location("#telluride", "Telluride", "offcampus", "Information about Telluride", false);
                var taylorcanyon = new Location("#tc", "Taylor Canyon", "offcampus", "Information about Taylor Canyon", false);
                var aspen = new Location("#aspen", "Aspen", "offcampus", "Information about Aspen", false);
                var crestedbutte = new Location("#cb", "Crested Butte", "offcampus", "Info about Crested Butte", false);
                var monarchmountain = new Location("#mm", "Monarch Mountain", "offcampus", "Info about Monarch Mountain", false);
                var taylorreservoir = new Location("#tr", "Taylor Reservoir", "offcampus", "Info about Taylor Reservoir", false);
                var hartmanrocks = new Location("#hr", "Hartman Rocks", "recreation", "Info about Hartman rocks", false);

                var locations = [taylor, quigley, hurst, kelley, library, universitycenter, footballfield, telluride,
                    taylorcanyon, aspen, crestedbutte, monarchmountain, taylorreservoir, hartmanrocks];

                var currentLocation;

                function getLocation(locationTag) {
                    $('.caption_wrapper:last').hide();
                    for (var i in locations) {
                        if (locationTag === locations[i].tag) {
                            $(".caption_title").html(locations[i].name); //getLocation name here 
                            $(".caption_text").html(locations[i].description);
                            fade();
                            currentLocation = locations[i];
                            break;
                        }
                    }
                }

                /**
                 * Fade in/out text overlay
                 */
                function fade() {
                    $('.caption_wrapper').fadeIn().delay(3000);
                    $('.caption_wrapper').fadeOut(2000);
                }

                /**
                 * Creates an instance of a Navigation Item
                 * @constructor
                 * @this {Navigation}
                 * @param {string} tag The location tag of the navigation item (should be in form # + location, i.e #hurst
                 * @param {string} name The name of the navigation item corresponding to div id to be filled
                 * @param {string} ttip Tool tip
                 * @param {string} destination The hash location destination (i.e. "#hurst)
                 * @param {string} direction The direction of navigation arrow (i.e. "back", "forward", "right", "left")
                 * @param {number} x x coordinate in pixels (for on campus) 
                 * @param {number} y y coordinate in pixels (for on campus) 
                 */
                function Navigation(tag, name, ttip, dest, direction, x, y) {
                    this.tag = tag;
                    this.name = name;
                    this.ttip = ttip;
                    this.dest = dest;
                    this.direction = direction;
                    this.x = x;
                    this.y = y;
                }

                /**
                 * Navigation object instances
                 */
                var taylor_to_pathway = new Navigation("#taylor", "taylor_to_pathway", "to pathway", "#pathway", "forward", 700, 150); //
                var pathway_to_hurst = new Navigation("#pathway", "pathway_to_hurst", "to Hurst", "#hurst", "forward", 700, 150);
                var pathway_to_taylor = new Navigation("#pathway", "pathway_to_taylor", "back to Taylor", "#taylor", "back", 700, 0); //
                var pathway_to_quigly = new Navigation("#pathway", "pathway_to_quigly", "to Quigly", "#quigley", "right", 800, 130);
                var hurst_to_pathway = new Navigation("#hurst", "hurst_to_pathway", "back to pathway", "#pathway", "back", 700, 0);
                var hurst_to_kelley = new Navigation("#hurst", "hurst_to_kelley", "to Kelley Hall", "#kelley", "left", 600, 130);
                var quigly_to_pathway = new Navigation("#quigley", "quigly_to_pathway", "back to pathway", "#pathway", "left", 600, 130);
                var kelley_to_hurst = new Navigation("#kelley", "kelley_to_hurst", "to Hurst Hall", "#hurst", "right", 800, 130);
                var kelley_to_pathway2 = new Navigation("#kelley", "kelley_to_pathway2", "to pathway", "#pathway2", "left", 600, 130);
                var pathway2_to_library = new Navigation("#pathway2", "pathway2_to_library", "to Library", "#library", "forward", 700, 150);
                var pathway2_to_kelley = new Navigation("#pathway2", "pathway2_to_kelley", "to Kelley Hall", "#kelley", "back", 700, 0);
                var library_to_pathway2 = new Navigation("#library", "library_to_pathway2", "to pathway", "#pathway2", "back", 700, 0);
                var library_to_universitycenter = new Navigation("#library", "library_to_universitycenter", "to University Center", "#universitycenter", "forward", 700, 150);
                var universitycenter_to_library = new Navigation("#universitycenter", "universitycenter_to_library", "to Library", "#library", "right", 800, 130);
                var universitycenter_to_footballfield = new Navigation("#universitycenter", "universitycenter_to_footballfield", "to Football Field", "#footballfield", "left", 600, 130);
                var footballfield_to_universitycenter = new Navigation("#footballfield", "footballfield_to_universitycenter", "to University Center", "#universitycenter", "right", 800, 130);
                var aspen_to_telluride = new Navigation("#aspen", "aspen_to_telluride", "to Telluride", "#telluride", "right", 800, 130);
                var telluride_to_aspen = new Navigation("#telluride", "telluride_to_aspen", "to Aspen", "#aspen", "left");
                var telluride_to_cb = new Navigation("#telluride", "telluride_to_cb", "to Crested Butte", "#cb", "right");
                var cb_to_telluride = new Navigation("#cb", "cb_to_telluride", "to Telluride", "#telluride", "left");
                var cb_to_mm = new Navigation("#cb", "cb_to_mm", "to Monarch Mountain", "#mm", "right");
                var mm_to_cb = new Navigation("#mm", "mm_to_cb", "to Crested Butte", "#cb", "left");
                var mm_to_tr = new Navigation("#mm", "mm_to_tr", "to Taylor Resevoir", "#tr", "right");
                var tr_to_mm = new Navigation("#tr", "tr_to_mm", "to Monarch Mountain", "#mm", "left");
                var tr_to_hr = new Navigation("#tr", "tr_to_hr", "to Hartman's Rocks", "#hr", "right");
                var hr_to_tr = new Navigation("#hr", "hr_to_tr", "to Taylor Resevoir", "#tr", "left");
                var hr_to_tc = new Navigation("#hr", "hr_to_tc", "to Taylor Canyon", "#tc", "right");
                var tc_to_hr = new Navigation("#tc", "tc_to_hr", "to Hartman's Rocks", "#hr", "left");
                var tc_to_taylor = new Navigation("#tc", "tc_to_taylor", "to Taylor Hall", "#taylor", "right");
                var hurst_to_aspen = new Navigation("#hurst", "hurst_to_aspen", "To Aspen", "#aspen", "right", 800, 130);
                var aspen_to_hurst = new Navigation("#aspen", "aspen_to_hurst", "back to Hurst Hall", "#hurst", "left"); 

                var navs = [taylor_to_pathway, pathway_to_hurst, pathway_to_taylor, pathway_to_quigly, hurst_to_pathway,
                    hurst_to_kelley, quigly_to_pathway, kelley_to_hurst, kelley_to_pathway2, pathway2_to_library,
                    pathway2_to_kelley, library_to_pathway2, library_to_universitycenter, universitycenter_to_library,
                    universitycenter_to_footballfield, footballfield_to_universitycenter, aspen_to_telluride, telluride_to_aspen,
                    telluride_to_cb, cb_to_telluride, cb_to_mm, mm_to_cb, mm_to_tr, tr_to_mm, tr_to_hr, hr_to_tr, hr_to_tc, tc_to_hr,
                    tc_to_taylor, hurst_to_aspen, aspen_to_hurst];

                /**
                 *  Render all navigation items at the current location
                 * @param {string} locationTag Location tag, should be in form "#" + location, i.e. "#hurst"
                 */
                function getNavs(locationTag) {
                    $('.tipsy:last').remove();
                    var inner_html = "";
                    var items = [];
                    for (var i in navs) {
                        if (currentLocation.onCampus) {
                            if (navs[i].tag === locationTag) {
                                inner_html += "<img onclick=javascript:window.location.hash='" + navs[i].dest + "' class='" +
                                        navs[i].name + " arrow' src='imgs/nav_arrows/" + navs[i].direction + "_white.png'" +
                                        "onmouseover=" + "this.src='imgs/nav_arrows/" + navs[i].direction + "_hover.png'" +
                                        " onmouseout=" + "this.src='imgs/nav_arrows/" + navs[i].direction + "_white.png' " +
                                        "title='" + navs[i].ttip + "' />";
                                items.push(navs[i].name);
                            }
                            $("#navigation").html(inner_html);
                            $(".arrow").tipsy({gravity: 's', fade: true, html: true});
                            for (var i in items) {
                                for (var j in navs) {
                                    if (items[i] === navs[j].name) {
                                        $("." + navs[j].name).css({bottom: navs[j].y + "px", "left": navs[j].x + "px"});
                                    }
                                }
                            }
                        }
                        else {
                            if (navs[i].tag === locationTag) {
                                inner_html += "<img onclick=javascript:window.location.hash='" + navs[i].dest + "' class='" +
                                        navs[i].direction + "_offcampus arrow' src='imgs/nav_arrows/" + navs[i].direction + "_offcampus.png'" +
                                        "onmouseover=" + "this.src='imgs/nav_arrows/" + navs[i].direction + "_offcampus_hover.png'" +
                                        " onmouseout=" + "this.src='imgs/nav_arrows/" + navs[i].direction + "_offcampus.png' " +
                                        "title='" + navs[i].ttip + "' />";
                            }
                            $("#navigation").html(inner_html);
                            $(".arrow").tipsy({gravity: 's', fade: true, html: true});
                        }
                    }
                }

                /**
                 * Creates an instance of a Hotspot
                 * @constructor
                 * @this {Hspot}
                 * @param {string} tag The location tag of the hotspot (should be in form # + location, i.e #hurst
                 * @param {string} name The name of the location corresponding to div id to be filled
                 * @param {Number} xLoc The x coordinate of the hotspot.
                 * @param {Number} yLoc The y coordinate of the hotspot.
                 * @param {Number} width The width of the hotspot.
                 * @param {Number} height The height of the hotspot.
                 * @param {Number} ttipWidth The width of the tooltip.
                 * @param {string} image The html code for image, i.e "<img src = . . ."
                 * @param {string} position The position of the tooltip in relation to hspot, i.e. "top", "bottom", "left", "right"
                 * @param {string} type of hotspot, i.e. "spot", "rect"
                 */
                function Hspot(tag, name, xLoc, yLoc, width, height, text, ttipWidth, image, position, type) {
                    this.tag = tag;
                    this.name = name;
                    this.xLoc = xLoc;
                    this.yLoc = yLoc;
                    this.width = width;
                    this.height = height;
                    this.text = text;
                    this.ttipWidth = ttipWidth;
                    this.image = image;
                    this.position = position;
                    this.type = type;
                }

                /**
                 * Hspot object instances
                 */
                var taylor_hotspot = new Hspot("#taylor", "taylor_hotspot", 70, 30, 15, 30, "Taylor Hall", 100, null, "bottom", "spot");
                var pathway_hotspot = new Hspot("#pathway", "pathway_hotspot", 70, 30, 8, 8, "some trees", 100, null, "left", "rect");
                var hurst_hotspot = new Hspot("#hurst", "hurst_hotspot", 50, 34, 30, 30, "This is Hurst, the building above all buildings. Check out the super cool things about it. So much Hurst.", 200, null, "bottom", "spot");
                var hotspots = [taylor_hotspot, pathway_hotspot, hurst_hotspot];

                /**
                 * Render all hotspots at the current location
                 * @param {string} locationTag Location tag, should be in form "#" + location, i.e. "#Hurst"
                 */
                function getHspots(locationTag) {
                    var inner_html = "";
                    for (var i in hotspots) {
                        if (hotspots[i].tag === locationTag) {
                            var hotspotsDiv = "#hotspots";
                            inner_html += "<div class='hs-spot-object' data-tint-color='#e52929' data-type=" + hotspots[i].type +
                                    " data-x =" + hotspots[i].xLoc + " data-y =" + hotspots[i].yLoc + " data-width = " + hotspots[i].width + " data-height = " + hotspots[i].height + " data-popup-position = " + hotspots[i].position +
                                    " data-visible = 'visible'" +
                                    "data-tooltip-width =" + hotspots[i].ttipWidth + " data-tooltip-auto-width= 'false'> " + hotspots[i].text + " </div>";
                        }
                    }
                    $(".icon-clear").css({'fill': "black", "color": "white"});
                    $(hotspotsDiv).html(inner_html);
                }

                /**
                 * Render main image for the current location
                 * @param {string} locationTag Location tag, should be in form "#" + location, i.e. "#hurst"
                 * locationTag should match image file, i.e "hurst_main.jpg" (substring removes "#")
                 */
                function getImage(locationTag) {
                    var mainImageDiv = "#main_image";
                    $(mainImageDiv).html("<img src='imgs/" + locationTag.substring(1) + "_main.jpg'/>");
                }

                /***Currently using location.hash, this will likely be replaced with getLocation()?
                 * Functions above requires the location tag passed in to be # + location tag name. (i.e "#hurst")
                 */
                $(window).on('hashchange', function () {
                    getImage(location.hash);
                    getLocation(location.hash);
                    getNavs(location.hash);
                });
            });
        </script>
    </head>
    <body class="contextual_navigation">
        <div class="contextual_assets">
            <section class="show" id="start">
                <a href ="#taylor">
                    <button class="beginButton">Begin Tour</button>
                </a>
            </section>
            <div id="main_image" class="noselect">
            </div>
            <div id="navigation">
            </div>
            <div class="caption_wrapper">
                <div class="caption">
                    <div class="caption_title">
                    </div> 
                    <div class="caption_text">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>